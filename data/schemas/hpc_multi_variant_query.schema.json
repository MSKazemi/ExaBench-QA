{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://exabench.org/schemas/hpc_multi_variant_query.schema.json",
  "title": "HPC Multi-Variant Query Schema",
  "description": "A single canonical query with multiple role-specific variants for benchmarking and generation.",
  "type": "object",
  "properties": {
    "query_id": {
      "type": "string",
      "minLength": 1,
      "pattern": "^Q-[A-Z0-9\\-]+$",
      "description": "Stable identifier (e.g., Q-ENERGY-042)."
    },
    "query_template": {
      "type": "string",
      "minLength": 1,
      "description": "Generalized form of the question (role-agnostic)."
    },
    "category": {
      "type": "string",
      "enum": [
        "Job & Workflow Management",
        "Performance & Optimization",
        "Data & Storage Management",
        "Monitoring & Observability",
        "Power, Energy & Sustainability",
        "Security, Access & Policy Management",
        "Facility, Infrastructure & Environmental Systems",
        "System Architecture, Design & Capacity Planning",
        "AI, Automation & Intelligent Operations",
        "Documentation, Support & Knowledge Assistance"
      ],
      "description": "Functional domain of the query."
    },
    "description": {
      "type": "string",
      "description": "Short explanation of what this query investigates or why it's asked."
    },
    "difficulty": {
      "type": "string",
      "enum": ["easy", "medium", "hard", "edge"],
      "description": "Default complexity for the overall query (variants may override)."
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Keywords for filtering and analytics."
    },
    "roles_covered": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "Normal HPC User",
          "HPC Researcher",
          "System Administrator",
          "Facility Admin / Technicians",
          "System Designer / Architect"
        ]
      },
      "minItems": 1,
      "uniqueItems": true,
      "description": "Summary of the roles represented in variants[]."
    },
    "variants": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "variant_id": {
            "type": "string",
            "description": "Optional sub-ID (e.g., Q-ENERGY-042:admin)."
          },
          "user_type": {
            "type": "string",
            "enum": [
              "Normal HPC User",
              "HPC Researcher",
              "System Administrator",
              "Facility Admin / Technicians",
              "System Designer / Architect"
            ],
            "description": "Persona for this variant."
          },
          "intent": {
            "type": "string",
            "description": "Role-specific goal/purpose of the query."
          },
          "data_scope": {
            "type": "string",
            "description": "Scope of data this variant may access (e.g., user jobs, cluster-wide, facility sensors)."
          },
          "data_sources": {
            "type": "array",
            "items": { "type": "string" },
            "minItems": 1,
            "description": "Telemetry/DB/APIs required (e.g., SLURM, Prometheus, IPMI, Kepler)."
          },
          "query_text": {
            "type": "string",
            "description": "Concrete natural-language query for this role."
          },
          "expected_answer": {
            "type": "string",
            "enum": ["table", "chart", "fact", "explanation"],
            "description": "Expected response format."
          },
          "expected_output": {
            "type": "string",
            "description": "Human description of the output (e.g., 'daily kWh per rack as a time series')."
          },
          "difficulty": {
            "type": "string",
            "enum": ["easy", "medium", "hard", "edge"],
            "description": "Optional override of overall difficulty for this variant."
          },
          "priority": {
            "type": "string",
            "enum": ["low", "medium", "high"],
            "description": "Benchmark importance for this variant."
          },
          "evaluation_signal": {
            "type": "string",
            "enum": ["exact_match", "range_check", "trend_direction_check", "heuristic_scoring"],
            "description": "How correctness is verified/scored."
          },
          "dependencies": {
            "type": "array",
            "items": { "type": "string" },
            "description": "External mappings/resources (e.g., rack_node_mapping, policy_docs)."
          },
          "dedupe_of": {
            "type": ["string", "null"],
            "description": "If this variant is a duplicate, reference another query_id or variant_id."
          },
          "notes": {
            "type": "string",
            "description": "Free-text annotations/caveats."
          }
        },
        "required": ["user_type", "intent", "data_sources", "query_text", "expected_answer"]
        ,
        "additionalProperties": false
      }
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Creation or last-modified timestamp."
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version of this query template (e.g., 1.0.0)."
    },
    "notes": {
      "type": "string",
      "description": "Global notes for the canonical query."
    }
  },
  "required": ["query_id", "query_template", "category", "variants"],
  
  "additionalProperties": false
  
}

